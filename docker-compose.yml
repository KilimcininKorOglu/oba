services:
  oba:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "1389:1389"
    volumes:
      - ./docker-data:/var/lib/oba
    environment:
      - OBA_LOG_LEVEL=debug
    command: ["./bin/oba", "serve", "--config", "/var/lib/oba/config.yaml"]
    restart: unless-stopped

  oba-dev:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "2389:1389"
    volumes:
      - .:/app
      - ./docker-data:/var/lib/oba
    environment:
      - OBA_LOG_LEVEL=debug
    command: ["go", "run", "./cmd/oba", "serve", "--config", "/var/lib/oba/config.yaml"]
    profiles:
      - dev
